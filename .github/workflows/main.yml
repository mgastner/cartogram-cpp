name: Json_to_md

on:
  push:
    branches: [ "main","github-actions-python"]
    paths: ['**.json', '**.geojson']

jobs:
  changes:
    runs-on: ubuntu-latest  
    name: get changed files
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Get changed files
        id: changed-files
        uses: tj-actions/changed-files@v29.0.3 

      - name: List all changed files
        run: |
          for file in ${{ steps.changed-files.outputs.all_modified_files }}; do
            echo "$file was changed"
          done
      
      - uses: actions/setup-python@v2
      - uses: BSFishy/pip-action@v1
        with: 
           packages: |
            jsonschema2md
      
      - uses: jannekem/run-python-script-action@v1
        with:
          script: |
            import json
            import jsonschema2md
            
            parser = jsonschema2md.Parser(
                examples_as_yaml=False,
                show_examples="all",
                )
            with open("./testing.json") as json_file, open("./testing.md", 'w') as output_markdown:
                output_md = parser.parse_schema(json.load(json_file))
                output_markdown.writelines(output_md)
      
      - uses: EndBug/add-and-commit@v9.1.0
      
      

